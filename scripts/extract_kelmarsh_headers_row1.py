import csv
import os

header_line = r'''# Date and time,Wind speed (m/s),"Wind speed, Standard deviation (m/s)","Wind speed, Minimum (m/s)","Wind speed, Maximum (m/s)",Long Term Wind (m/s),Wind speed Sensor 1 (m/s),"Wind speed Sensor 1, Standard deviation (m/s)","Wind speed Sensor 1, Minimum (m/s)","Wind speed Sensor 1, Maximum (m/s)",Wind speed Sensor 2 (m/s),"Wind speed Sensor 2, Standard deviation (m/s)","Wind speed Sensor 2, Minimum (m/s)","Wind speed Sensor 2, Maximum (m/s)",Density adjusted wind speed (m/s),Wind direction (°),Nacelle position (°),"Wind direction, Standard deviation (°)","Wind direction, Minimum (°)","Wind direction, Maximum (°)","Nacelle position, Standard deviation (°)","Nacelle position, Minimum (°)","Nacelle position, Maximum (°)",Vane position 1+2 (°),"Vane position 1+2, Max (°)","Vane position 1+2, Min (°)","Vane position 1+2, StdDev (°)",Energy Export (kWh),Energy Export counter (kWh),Energy Import (kWh),Energy Import counter (kWh),Lost Production (Contractual) (kWh),Lost Production (Time-based IEC B.2.2) (kWh),Lost Production (Time-based IEC B.2.3) (kWh),Lost Production (Time-based IEC B.2.4) (kWh),Lost Production (Time-based IEC B.3.2) (kWh),Lost Production (Production-based IEC B.2.2) (kWh),Lost Production (Production-based IEC B.2.3) (kWh),Lost Production (Production-based IEC B.3.2) (kWh),Energy Budget - Default (kWh),Energy Theoretical (kWh),Lost Production to Downtime (kWh),Lost Production to Performance (kWh),Lost Production Total (kWh),Lost Production to Curtailment (Total) (kWh),Lost Production to Curtailment (Grid) (kWh),Lost Production to Curtailment (Noise) (kWh),Lost Production to Curtailment (Shadow) (kWh),Lost Production to Curtailment (Bats) (kWh),Lost Production to Curtailment (Birds) (kWh),Lost Production to Curtailment (Ice) (kWh),Lost Production to Curtailment (Sector Management) (kWh),Lost Production to Curtailment (Technical) (kWh),Lost Production to Curtailment (Marketing) (kWh),Lost Production to Curtailment (Boat Action) (kWh),Compensated Lost Production (kWh),Virtual Production (kWh),Lost Production to Curtailment (Grid Constraint) (kWh),Lost Production to Downtime and Curtailment Total (kWh),Lost Production (Contractual Global) (kWh),Lost Production (Contractual Custom) (kWh),Power (kW),Potential power default PC (kW),"Power, Standard deviation (kW)","Power, Minimum (kW)","Power, Maximum (kW)",Potential power learned PC (kW),Potential power reference turbines (kW),Cascading potential power (kW),Cascading potential power for performance (kW),Potential power met mast anemometer (kW),Potential power primary reference turbines (kW),Potential power secondary reference turbines (kW),Turbine Power setpoint (kW),Potential power estimated (kW),Potential power MPC (kW),Potential power met mast anemometer MPC (kW),"Turbine Power setpoint, Max (kW)","Turbine Power setpoint, Min (kW)","Turbine Power setpoint, StdDev (kW)",Available Capacity for Production (kW),Available Capacity for Production (Planned) (kW),Power factor (cosphi),"Power factor (cosphi), Max","Power factor (cosphi), Min","Power factor (cosphi), Standard deviation",Reactive power (kvar),"Reactive power, Max (kvar)","Reactive power, Min (kvar)","Reactive power, Standard deviation (kvar)",Front bearing temperature (°C),Rear bearing temperature (°C),Stator temperature 1 (°C),Nacelle ambient temperature (°C),Nacelle temperature (°C),Transformer temperature (°C),Gear oil inlet temperature (°C),Generator bearing rear temperature (°C),Generator bearing front temperature (°C),Gear oil temperature (°C),Temp. top box (°C),Hub temperature (°C),Ambient temperature (converter) (°C),Rotor bearing temp (°C),Transformer cell temperature (°C),"Front bearing temperature, Max (°C)","Front bearing temperature, Min (°C)","Front bearing temperature, Standard deviation (°C)","Rear bearing temperature, Max (°C)","Rear bearing temperature, Min (°C)","Rear bearing temperature, Standard deviation (°C)",Temperature motor axis 1 (°C),Temperature motor axis 2 (°C),Temperature motor axis 3 (°C),CPU temperature (°C),"Nacelle temperature, Max (°C)","Nacelle temperature, Min (°C)","Generator bearing front temperature, Max (°C)","Generator bearing front temperature, Min (°C)","Generator bearing rear temperature, Max (°C)","Generator bearing rear temperature, Min (°C)","Generator bearing front temperature, Std (°C)","Generator bearing rear temperature, Std (°C)","Nacelle temperature, Standard deviation (°C)","Gear oil temperature, Max (°C)","Gear oil temperature, Min (°C)","Gear oil temperature, Standard deviation (°C)","Hub temperature, min (°C)","Hub temperature, max (°C)","Hub temperature, standard deviation (°C)","Ambient temperature (converter), Max (°C)","Ambient temperature (converter), Min (°C)","Ambient temperature (converter), StdDev (°C)","Gear oil inlet temperature, Max (°C)","Gear oil inlet temperature, Min (°C)","Gear oil inlet temperature, StdDev (°C)","Nacelle ambient temperature, Max (°C)","Nacelle ambient temperature, Min (°C)","Nacelle ambient temperature, StdDev (°C)","Rotor bearing temp, Max (°C)","Rotor bearing temp, Min (°C)","Rotor bearing temp, StdDev (°C)","CPU temperature, Max (°C)","CPU temperature, Min (°C)","CPU temperature, StdDev (°C)","Transformer cell temperature, Max (°C)","Transformer cell temperature, Min (°C)","Transformer cell temperature, StdDev (°C)","Transformer temperature, Max (°C)","Transformer temperature, Min (°C)","Transformer temperature, StdDev (°C)","Stator temperature 1, Max (°C)","Stator temperature 1, Min (°C)","Stator temperature 1, StdDev (°C)","Temp. top box, Max (°C)","Temp. top box, Min (°C)","Temp. top box, StdDev (°C)","Temperature motor axis 1, Max (°C)","Temperature motor axis 1, Min (°C)","Temperature motor axis 1, StdDev (°C)","Temperature motor axis 2, Max (°C)","Temperature motor axis 2, Min (°C)","Temperature motor axis 2, StdDev (°C)","Temperature motor axis 3, Max (°C)","Temperature motor axis 3, Min (°C)","Temperature motor axis 3, StdDev (°C)",Voltage L1 / U (V),Voltage L2 / V (V),Voltage L3 / W (V),Grid voltage (V),"Grid voltage, Max (V)","Grid voltage, Min (V)","Grid voltage, Standard deviation (V)","Voltage L1 / U, Min (V)","Voltage L1 / U, Max (V)","Voltage L1 / U, Standard deviation (V)","Voltage L2 / V, Min (V)","Voltage L2 / V, Max (V)","Voltage L2 / V, Standard deviation (V)","Voltage L3 / W, Min (V)","Voltage L3 / W, Max (V)","Voltage L3 / W, Standard deviation (V)",Current L1 / U (A),Current L2 / V (A),Current L3 / W (A),Grid current (A),Motor current axis 1 (A),Motor current axis 2 (A),Motor current axis 3 (A),"Current L1 / U, min (A)","Current L1 / U, max (A)","Current L1 / U, StdDev (A)","Current L2 / V, max (A)","Current L3 / W, max (A)","Current L2 / V, min (A)","Current L2 / V, StdDev (A)","Current L3 / W, min (A)","Current L3 / W, StdDev (A)","Grid current, Max (A)","Grid current, Min (A)","Grid current, StdDev (A)","Motor current axis 1, Max (A)","Motor current axis 1, Min (A)","Motor current axis 1, StdDev (A)","Motor current axis 2, Max (A)","Motor current axis 2, Min (A)","Motor current axis 2, StdDev (A)","Motor current axis 3, Max (A)","Motor current axis 3, Min (A)","Motor current axis 3, StdDev (A)",Rotor speed (RPM),Generator RPM (RPM),Gearbox speed (RPM),"Generator RPM, Max (RPM)","Generator RPM, Min (RPM)","Generator RPM, Standard deviation (RPM)","Rotor speed, Max (RPM)","Rotor speed, Min (RPM)","Rotor speed, Standard deviation (RPM)","Gearbox speed, Max (RPM)","Gearbox speed, Min (RPM)","Gearbox speed, StdDev (RPM)",Capacity factor,Data Availability,Time-based Contractual Avail.,Time-based IEC B.2.2 (Users View),Time-based IEC B.2.3 (Users View),Time-based IEC B.2.4 (Users View),Time-based IEC B.3.2 (Manufacturers View),Production-based IEC B.2.2 (Users View),Production-based IEC B.2.3 (Users View),Production-based IEC B.3.2 (Manufacturers View),Time-based System Avail.,Production-based System Avail.,Production-based Contractual Avail.,Time-based System Avail. (Planned),Production-based System Avail. (virtual),Time-based Contractual Avail. (Global),Time-based Contractual Avail. (Custom),Production-based Contractual Avail. (Global),Production-based Contractual Avail. (Custom),Reactive Energy Export (kvarh),Reactive Energy Export counter (kvarh),Reactive Energy Import (kvarh),Reactive Energy Import counter (kvarh),Blade angle (pitch position) A (°),Blade angle (pitch position) B (°),Blade angle (pitch position) C (°),Yaw bearing angle (°),"Blade angle (pitch position) A, Max (°)","Blade angle (pitch position) A, Min (°)","Blade angle (pitch position) A, Standard deviation (°)","Blade angle (pitch position) B, Max (°)","Blade angle (pitch position) B, Min (°)","Blade angle (pitch position) B, Standard deviation (°)","Blade angle (pitch position) C, Max (°)","Blade angle (pitch position) C, Min (°)","Blade angle (pitch position) C, Standard deviation (°)","Yaw bearing angle, Max (°)","Yaw bearing angle, Min (°)","Yaw bearing angle, StdDev (°)",Gear oil inlet pressure (bar),Gear oil pump pressure (bar),"Gear oil inlet pressure, Max (bar)","Gear oil inlet pressure, Min (bar)","Gear oil inlet pressure, StdDev (bar)","Gear oil pump pressure, Max (bar)","Gear oil pump pressure, Min (bar)","Gear oil pump pressure, StdDev (bar)",Grid frequency (Hz),"Grid frequency, Max (Hz)","Grid frequency, Min (Hz)","Grid frequency, Standard deviation (Hz)",Equivalent Full Load Hours (s),Equivalent Full Load Hours counter (s),Production Factor,Performance Index,Apparent power (kVA),"Apparent power, Max (kVA)","Apparent power, Min (kVA)","Apparent power, StdDev (kVA)",Cable windings from calibration point,Metal particle count,Metal particle count counter,"Cable windings from calibration point, Max","Cable windings from calibration point, Min","Cable windings from calibration point, StdDev",Drive train acceleration (mm/ss),Tower Acceleration X (mm/ss),Tower Acceleration y (mm/ss),"Tower Acceleration X, Min (mm/ss)","Tower Acceleration X, Max (mm/ss)","Tower Acceleration Y, Min (mm/ss)","Tower Acceleration Y, Max (mm/ss)","Drive train acceleration, Max (mm/ss)","Drive train acceleration, Min (mm/ss)","Drive train acceleration, StdDev (mm/ss)","Tower Acceleration X, StdDev (mm/ss)","Tower Acceleration Y, StdDev (mm/ss)"'''

# remove leading '# ' if present
if header_line.startswith('#'):
    header_line = header_line.lstrip('#').strip()

reader = csv.reader([header_line])
cols = next(reader)
cols = [c.strip() for c in cols]

out_dir = os.path.join('data', 'kelmarsh_data')
os.makedirs(out_dir, exist_ok=True)
out_path = os.path.join(out_dir, 'kelmarsh_headers_row1.txt')
with open(out_path, 'w', encoding='utf-8') as fh:
    for c in cols:
        fh.write(c + '\n')

print('WROTE', out_path, 'columns:', len(cols))

